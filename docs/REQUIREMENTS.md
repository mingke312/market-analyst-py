# A股市场每日分析系统 - 需求文档

## 1. 项目概述

**项目名称：** A股市场每日分析系统

**目标：** 每日自动收集A股市场数据、分析市场趋势、生成报告并推送给用户

**用户：** 何甜（关注金融市场的个人投资者）

---

## 2. 功能需求

### 2.1 数据收集模块

#### 2.1.1 行情数据收集
- **数据源：** 腾讯财经 (gtimg.cn)
- **采集内容：**
  - 8个主要指数：上证指数、深证成指、沪深300、中证500、中证1000、上证50、科创50、创业板指
  - 每个指数包含：价格、涨跌幅、开盘价、最高价、最低价、成交量、成交额
- **采集频率：** 每日16:00（交易日）

#### 2.1.2 期货数据收集
- **数据源：** 东方财富 (eastmoney.com) - 浏览器自动化
- **采集内容：**
  - 4个股指期货：IF（沪深300）、IC（中证500）、IM（中证1000）、IH（上证50）
  - 3个合约期限：当月、下季、隔季
  - 每个合约包含：价格、涨跌幅、开高低、成交量、成交额、结算价
- **采集频率：** 每日16:00

#### 2.1.3 新闻数据收集
- **数据源：** 格隆汇 (gelonghui.com)
- **采集内容：**
  - 分类：宏观政策、行业动态、国际市场、公司重大事项、其他
  - 每个新闻包含：标题、来源、分类、重要性评分、发布时间
- **采集频率：** 每日16:00

### 2.2 数据分析模块

#### 2.2.1 成交量分析
- 近一个月成交量趋势分析
- 需要持续采集至少7天数据后才能产生有效分析

#### 2.2.2 基差分析
- 计算公式：基差 = 期货价格 - 现货价格
- 年化基差率 = (基差 / 现货价格) × (365 / 距到期交易日)
- 交易日计算：排除周末和法定节假日
- 期货到期日：每月第三个周五

#### 2.2.3 新闻分析
- 高重要性新闻筛选（重要性 = "高"）
- 市场情绪判断（基于关键词）
- 分类统计

### 2.3 报告生成模块

#### 2.3.1 报告结构
1. **行情分析**
   - 成交量趋势
   - 基差变化（IF/IC/IM/IH 当月/下季/隔季）
   - 涨跌幅统计（日/周/月）
2. **新闻分析**
   - 高重要性新闻摘要（标题 + 来源 + 分类）
   - 新闻影响分析
   - 市场情绪判断
3. **综合结论**
   - 市场判断
   - 风险提示
   - 投资建议

#### 2.3.2 报告格式
- 直接发送消息到飞书
- 支持 Markdown 格式

### 2.4 数据质量检查模块

#### 2.4.1 检查项目
- 行情数据：8个指数完整性、必填字段、数据合理性
- 期货数据：4个指数 × 3个合约、价格完整性
- 基差数据：所有指数和合约的基差计算完整性

#### 2.4.2 评分标准
- 100分：完美
- 90-99分：优秀
- 70-89分：合格
- <70分：不合格，需要重新抓取

#### 2.4.3 质量控制流程
1. 数据收集完成后立即进行质量检查
2. 如果评分 < 70，自动重新抓取缺失数据
3. 重新检查直到通过或达到最大重试次数

### 2.5 定时任务模块

- 每日16:00自动执行（北京时间）
- 执行流程：
  1. 收集行情数据
  2. 收集期货数据
  3. 收集新闻数据
  4. 数据质量检查
  5. 如果不通过，重新抓取
  6. 生成分析
  7. 生成报告
  8. 推送报告

---

## 3. 非功能需求

### 3.1 性能
- 数据收集总时间 < 5分钟
- 报告生成时间 < 30秒

### 3.2 可靠性
- 数据质量评分 >= 70分
- 失败重试机制（最多3次）

### 3.3 可维护性
- 模块化设计
- 清晰的日志输出
- 交易日历可更新

---

## 4. 扩展需求（未来）

- [ ] 美股数据收集
- [ ] 黄金、铜等大宗商品数据
- [ ] 数字货币数据
- [ ] 技术指标分析（MACD、KDJ等）
- [ ] 自定义提醒阈值
